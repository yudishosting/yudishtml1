<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Playlist Musik</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .folder, .song {
      cursor: pointer;
      background: #fff;
      margin: 5px auto;
      padding: 10px;
      border: 1px solid #ccc;
      max-width: 600px;
    }
    .folder:hover, .song:hover {
      background: #e0e0e0;
    }
    .song-list {
      margin-left: 30px;
    }
    audio {
      display: block;
      margin: 20px auto;
      width: 100%;
      max-width: 600px;
    }
    pre {
      background: #fff;
      padding: 15px;
      white-space: pre-wrap;
      border: 1px solid #ddd;
      max-width: 600px;
      margin: 10px auto;
    }
  </style>
</head>
<body>
  <h1>ðŸŽµ Playlist Musik</h1>
  <div id="folders"></div>
  <audio id="audioPlayer" controls autoplay></audio>
  <pre id="lyricsBox">Klik lagu untuk menampilkan lirik dan memutar lagu.</pre>

  <script>
    const artists = ['nina', 'yura']; // Tambahkan nama folder artis di sini
    const musicRoot = 'music/';
    const lyricsRoot = 'lyrics/';

    const foldersDiv = document.getElementById("folders");

    artists.forEach(artist => {
      const folderDiv = document.createElement("div");
      folderDiv.className = "folder";
      folderDiv.textContent = `ðŸŽ¤ ${artist}`;
      folderDiv.onclick = () => loadSongs(artist, folderDiv);
      foldersDiv.appendChild(folderDiv);
    });

    async function loadSongs(artist, container) {
      // Cegah load dua kali
      if (container.dataset.loaded === "true") return;
      container.dataset.loaded = "true";

      const songListDiv = document.createElement("div");
      songListDiv.className = "song-list";

      try {
        const list = await fetch(`${musicRoot}${artist}/`).then(res => res.text());
        const files = [...list.matchAll(/href="([^?"]+\.mp3)"/g)].map(match => match[1]);

        files.forEach(file => {
          const songName = file.replace('.mp3', '');
          const songDiv = document.createElement("div");
          songDiv.className = "song";
          songDiv.textContent = songName.replace(/_/g, ' ');
          songDiv.onclick = () => playSong({
            audio: `${musicRoot}${artist}/${file}`,
            lyrics: `${lyricsRoot}${artist}/${songName}.js`
          });
          songListDiv.appendChild(songDiv);
        });

        container.appendChild(songListDiv);
      } catch (err) {
        const errorDiv = document.createElement("div");
        errorDiv.textContent = "Gagal memuat lagu.";
        container.appendChild(errorDiv);
      }
    }

    function playSong({ audio, lyrics }) {
      const player = document.getElementById("audioPlayer");
      player.src = audio;
      player.play();

      const oldScript = document.getElementById("dynamicLyrics");
      if (oldScript) oldScript.remove();

      const script = document.createElement("script");
      script.id = "dynamicLyrics";
      script.src = lyrics;
      script.onload = () => {
        document.getElementById("lyricsBox").textContent = songData.lyrics || "Lirik tidak ditemukan.";
      };
      script.onerror = () => {
        document.getElementById("lyricsBox").textContent = "Lirik gagal dimuat.";
      };
      document.body.appendChild(script);
    }
  </script>
</body>
</html>